<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bill Database</title>

<style>
:root {
  --primary: #2c3e50;
  --header-blue: #3498db;
  --btn-blue: #2980b9;
  --success: #27ae60;
  --danger: #e74c3c;
}

body {
  font-family: -apple-system, BlinkMacSystemFont, sans-serif;
  background: #eef2f5;
  margin: 0;
  padding: 10px;
}

.container {
  max-width: 500px;
  margin: auto;
}

.day-block {
  background: white;
  border-radius: 15px;
  padding: 15px;
  margin-bottom: 15px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.08);
}

.day-header {
  background: var(--header-blue);
  color: white;
  padding: 8px;
  border-radius: 8px;
  margin: -15px -15px 15px -15px;
  text-align: center;
  font-weight: 600;
}

.row {
  display: flex;
  gap: 5px;
  margin-bottom: 6px;
}

input, select {
  padding: 8px;
  border-radius: 8px;
  border: 1px solid #ddd;
  font-size: 13px;
  width: 100%;
  box-sizing: border-box;
}

.type {
  flex: 0 0 95px;
}

.amount {
  flex: 0 0 85px;
}

.months {
  flex: 1;
}

.nav-btn {
  background: var(--primary);
  color: white;
  border: none;
  border-radius: 10px;
  padding: 10px;
  width: 100%;
  font-weight: bold;
  margin-bottom: 15px;
}

.save-btn {
  background: var(--btn-blue);
  color: white;
  border: none;
  border-radius: 12px;
  padding: 14px;
  width: 100%;
  font-weight: bold;
  font-size: 14px;
  margin: 30px 0;
}
</style>
</head>

<body>

<div class="container">

  <!-- Back Button -->
  <button class="nav-btn" onclick="goBack()">‚Üê Back to Bill Tracker</button>

  <h2 style="text-align:center;color:var(--primary);margin-bottom:15px;">
    Bill Database
  </h2>

  <div id="daysContainer"></div>

  <button class="save-btn" onclick="saveDB()">Save Database</button>
</div>

<script>
const months = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];
const MAX_LINES = 5;

function loadDB() {
  return JSON.parse(localStorage.getItem('bill_db_v1')) || {
    recurring: {},
    seasonal: []
  };
}

function renderDB() {
  const container = document.getElementById('daysContainer');
  container.innerHTML = '';

  for (let day = 1; day <= 31; day++) {
    container.innerHTML += `
      <div class="day-block">
        <div class="day-header">DAY ${day}</div>
        ${Array.from({ length: MAX_LINES }).map(() => `
          <div class="row">
            <input placeholder="Vendor">
            <input type="number" placeholder="$" class="amount" step="0.01">
            <select class="type">
              <option value="recurring">Recurring</option>
              <option value="seasonal">Seasonal</option>
            </select>
            <select class="months" multiple>
              ${months.map((m,i)=>`<option value="${i}">${m}</option>`).join('')}
            </select>
          </div>
        `).join('')}
      </div>
    `;
  }
}

function saveDB() {
  let db = { recurring: {}, seasonal: [] };

  document.querySelectorAll('.day-block').forEach((block, index) => {
    const day = index + 1;
    block.querySelectorAll('.row').forEach(row => {
      const ven = row.children[0].value.trim();
      const amt = parseFloat(row.children[1].value);
      const type = row.children[2].value;
      const monthsSel = Array.from(row.children[3].selectedOptions).map(o => +o.value);

      if (!ven || !amt) return;

      if (type === 'recurring') {
        if (!db.recurring[day]) db.recurring[day] = [];
        db.recurring[day].push({ ven, amt });
      } else {
        db.seasonal.push({
          day,
          ven,
          amt,
          months: monthsSel
        });
      }
    });
  });

  localStorage.setItem('bill_db_v1', JSON.stringify(db));
  alert('Database saved successfully');
}

function goBack() {
  window.location.href = 'Bill_Tracker.html';
}

window.onload = renderDB;
</script>

</body>
</html>
